This is quite awful, it might need a complete rewrite in order to actually function. 
